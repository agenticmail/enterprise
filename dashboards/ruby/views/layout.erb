<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>AgenticMail Enterprise - Ruby Dashboard</title>
<link rel="stylesheet" href="/styles.css">
</head>
<body>
<aside class="sidebar">
  <div class="sidebar-brand">
    &#127970; AgenticMail Enterprise
    <small>Admin Dashboard &middot; Ruby</small>
  </div>
  <nav class="sidebar-nav">
    <a href="/" class="<%= active?('/') %>"><span>&#128202;</span> <span>Dashboard</span></a>
    <a href="/agents" class="<%= active?('/agents') %>"><span>&#129302;</span> <span>Agents</span></a>
    <a href="/users" class="<%= active?('/users') %>"><span>&#128101;</span> <span>Users</span></a>
    <a href="/api-keys" class="<%= active?('/api-keys') %>"><span>&#128273;</span> <span>API Keys</span></a>
    <a href="/vault" class="<%= active?('/vault') %>"><span>&#128274;</span> <span>Vault</span></a>
    <a href="/skills" class="<%= active?('/skills') %>"><span>&#128295;</span> <span>Skills</span></a>
    <a href="/audit" class="<%= active?('/audit') %>"><span>&#128220;</span> <span>Audit Log</span></a>
    <a href="/settings" class="<%= active?('/settings') %>"><span>&#9881;&#65039;</span> <span>Settings</span></a>
    <small style="display:block;padding:12px 16px 4px;color:var(--text-muted);text-transform:uppercase;font-size:10px;letter-spacing:1px">Management</small>
    <a href="/messages" class="<%= active?('/messages') %>"><span>&#128231;</span> <span>Messages</span></a>
    <a href="/guardrails" class="<%= active?('/guardrails') %>"><span>&#128737;</span> <span>Guardrails</span></a>
    <a href="/journal" class="<%= active?('/journal') %>"><span>&#128214;</span> <span>Journal</span></a>
    <a href="/dlp" class="<%= active?('/dlp') %>"><span>&#128274;</span> <span>DLP</span></a>
    <a href="/compliance" class="<%= active?('/compliance') %>"><span>&#128203;</span> <span>Compliance</span></a>
  </nav>
  <div class="sidebar-footer">
    <div style="margin-bottom:6px"><%= escape_html(current_user['email'] || current_user['name'] || 'Admin') %></div>
    <a href="/logout">Sign out</a>
    &nbsp;&middot;&nbsp;
    <button class="theme-toggle" title="Toggle dark mode">&#127763;</button>
  </div>
</aside>
<main class="main">
  <%= flash_messages %>
  <%= yield %>
</main>
<script>
// Dark mode persistence
if(localStorage.getItem('dark')==='1') document.documentElement.setAttribute('data-theme','dark');
document.querySelector('.theme-toggle')?.addEventListener('click',function(){
  var d=document.documentElement.hasAttribute('data-theme');
  if(d){document.documentElement.removeAttribute('data-theme');localStorage.removeItem('dark')}
  else{document.documentElement.setAttribute('data-theme','dark');localStorage.setItem('dark','1')}
});
</script>
</body>
</html>
