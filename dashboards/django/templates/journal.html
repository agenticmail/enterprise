{% extends "layout.html" %}
{% block content %}
<h2 class="t">Journal</h2>
<p class="desc">Action journal with stats and rollback capability</p>
<div class="stats">
<div class="stat"><div class="l">Total Entries</div><div class="v">{{ stats.totalEntries|default:"0" }}</div></div>
<div class="stat"><div class="l">Actions Today</div><div class="v">{{ stats.actionsToday|default:"0" }}</div></div>
<div class="stat"><div class="l">Rollbacks</div><div class="v">{{ stats.rollbacks|default:"0" }}</div></div>
<div class="stat"><div class="l">Pending</div><div class="v">{{ stats.pending|default:"0" }}</div></div>
</div>
<div class="card">
<div class="ct">Entries</div>
{% if entries %}
<table>
<thead><tr><th>Time</th><th>Agent</th><th>Action</th><th>Resource</th><th>Status</th><th></th></tr></thead>
<tbody>
{% for e in entries %}
<tr>
<td style="font-size:12px;color:var(--muted)">{{ e.timestamp }}</td>
<td style="font-weight:600">{{ e.agentName|default:e.agent_name }}</td>
<td style="color:var(--primary);font-weight:500">{{ e.action }}</td>
<td style="font-size:12px">{{ e.resource|default:"-" }}</td>
<td>{{ e.status_badge|safe }}</td>
<td>
<form method="POST" style="display:inline">
<input type="hidden" name="_action" value="rollback">
<input type="hidden" name="entry_id" value="{{ e.id }}">
<button class="btn btn-sm btn-d" type="submit">Rollback</button>
</form>
</td>
</tr>
{% endfor %}
</tbody>
</table>
{% else %}
<div class="empty">&#x1f4d3; No journal entries yet</div>
{% endif %}
</div>
{% endblock %}
