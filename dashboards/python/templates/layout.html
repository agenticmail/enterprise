<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AgenticMail Enterprise — Python</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <div class="sidebar">
    <div class="sidebar-brand">
      AgenticMail
      <small>Enterprise &middot; Python</small>
    </div>
    <nav class="sidebar-nav">
      <a href="{{ url_for('dashboard_bp.dashboard') }}" class="{{ 'active' if active_page == 'dashboard' }}">
        <span>Dashboard</span>
      </a>
      <a href="{{ url_for('agents_bp.agents') }}" class="{{ 'active' if active_page == 'agents' }}">
        <span>Agents</span>
      </a>
      <a href="{{ url_for('users_bp.users') }}" class="{{ 'active' if active_page == 'users' }}">
        <span>Users</span>
      </a>
      <a href="{{ url_for('api_keys_bp.api_keys') }}" class="{{ 'active' if active_page == 'api_keys' }}">
        <span>API Keys</span>
      </a>
      <a href="{{ url_for('vault_bp.vault') }}" class="{{ 'active' if active_page == 'vault' }}">
        <span>Vault</span>
      </a>
      <a href="{{ url_for('skills_bp.skills') }}" class="{{ 'active' if active_page == 'skills' }}">
        <span>Skills</span>
      </a>
      <a href="{{ url_for('audit_bp.audit') }}" class="{{ 'active' if active_page == 'audit' }}">
        <span>Audit Log</span>
      </a>
      <a href="{{ url_for('dlp_bp.dlp') }}" class="{{ 'active' if active_page == 'dlp' }}">
        <span>DLP</span>
      </a>
      <a href="{{ url_for('compliance_bp.compliance') }}" class="{{ 'active' if active_page == 'compliance' }}">
        <span>Compliance</span>
      </a>

      <div style="padding: 12px 16px 4px; font-size: 10px; text-transform: uppercase; letter-spacing: 1px; color: var(--text-muted);">Management</div>
      <a href="{{ url_for('messages_bp.messages') }}" class="{{ 'active' if active_page == 'messages' }}">
        <span>Messages</span>
      </a>
      <a href="{{ url_for('guardrails_bp.guardrails') }}" class="{{ 'active' if active_page == 'guardrails' }}">
        <span>Guardrails</span>
      </a>
      <a href="{{ url_for('journal_bp.journal') }}" class="{{ 'active' if active_page == 'journal' }}">
        <span>Journal</span>
      </a>
      <a href="{{ url_for('settings_bp.settings') }}" class="{{ 'active' if active_page == 'settings' }}">
        <span>Settings</span>
      </a>
    </nav>
    <div class="sidebar-footer">
      <div>{{ user.name }}</div>
      <div style="color: var(--text-muted); font-size: 11px;">{{ user.email }}</div>
      <a href="{{ url_for('auth_bp.logout') }}" style="margin-top: 6px; display: inline-block;">Sign out</a>
    </div>
  </div>

  <div class="main">
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for m in messages %}
          {% if 'Key created:' in m %}
          <div class="key-banner">
            Save this key now — it will not be shown again!
            <code>{{ m.replace('Key created: ', '').replace(' — SAVE THIS NOW!', '') }}</code>
          </div>
          {% else %}
          <div class="flash flash-success">{{ m }}</div>
          {% endif %}
        {% endfor %}
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
  </div>

  {% block scripts %}{% endblock %}
</body>
</html>
